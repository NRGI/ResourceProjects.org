.container
   .page-header
      h1
         span(ng-bind-html="company.name|sanitize")
         =' '
         small Company
   .row
      .col-md-12
         leaflet(center="company.countryMap",controls="controls",markers="company.projectMarkers",tiles="tiles", height='240px')
   .row
      .col-md-6
         .info-box
            h2 Company Info
            table#project-info
               tbody
                  tr
                     td.project-label.our-id Our Company ID:
                     td {{company.id}}
                  tr
                     td.project-label.website Website:
                     td
                        a(href='{{company.website}}') {{company.website}}
                  tr
                     td.project-label.country Country:
                     td
                        a(href='country/{{company.countryId}}')
                           span(ng-bind-html="company.country|sanitize")
                  tr
                     td.project-label.part-of Part of:
                     td
                        a(href='group/{{company.groupId}}')
                           span(ng-bind-html="company.group|sanitize")
                  tr
                     td.project-label.open-corporates Open Corporates:
                     td
                        a(href='{{company.openCorporates}}') {{company.openCorporates}}
      .col-md-6
         h2 Projects
         table.table.table-striped.projects(ts-wrapper,ng-if='company.projects.length!=0')
            thead
               tr
                  th.tablesort-sortable-th(ts-criteria='name') Name
                  th.tablesort-sortable-th(ts-criteria='country') Country
                  th.tablesort-sortable-th(ts-criteria='type') Commodity Type
            tbody
               tr(ng-repeat='project in company.projects',ts-repeat)
                  td
                     a(href='project/{{project.id}}')
                        span(ng-bind-html="project.name|sanitize")
                  td
                     a(href='country/{{project.countryId}}')
                        span(ng-bind-html="project.country|sanitize")
                  td {{project.type}}
         .download
            span.glyphicon.glyphicon-download(aria-hidden='true')
            span
               |  Download:
               =' '
               a(href='/sparql?default-graph-uri=&query=prefix+rp%3A+%3Chttp%3A%2F%2Fresourceprojects.org%2Fdef%2F%3E%0Aprefix+rp_misc%3A+%3Chttp%3A%2F%2Fresourceprojects.org%2Fdef%2Fmisc%2F%3E%0Aprefix+skos_%3A+%3Chttp%3A%2F%2Fwww.w3.org%2F2004%2F02%2Fskos%2Fcore%23%3E%0A%0ASELECT+DISTINCT+%3Fproject+%3Fname+%3Fcountry+%3Fcountry_name+%3FcommodityType+WHERE+%7B%0A++++%3Chttp%3A%2F%2Fresourceprojects.org%2Fcompany%2F2f2508fdb642e947%3E+rp%3AholdsStake+%3Fstakes+.%0A++++%3Fstakes+rp%3AisStakeIn+%3Fproject+.%0A++++%3Fproject+a+rp%3AProject++.%0A++++%3Fproject+skos_%3AprefLabel+%3Fname+.%0A++++%0A++++OPTIONAL+%7B%0A%0A++++++%3Fproject+rp%3AhasLocation+%3Fcountry+.%0A++++++%3Fcountry+a+rp%3ACountry+.%0A++++++%3Fcountry+skos_%3AprefLabel+%3Fcountry_name+%0A++++++OPTIONAL+%7B+%3Fproject+rp%3AhasCommodity+%3Fcommodity+.%0A++++++++++++++++%3Fcommodity+rp%3AcommodityType+%3FcommodityType+%0A++++++%7D%0A++++++%0A++++%7D%0A%0A%7D%0AGROUP+BY+%3Fproject+%3Fname%0AORDER+BY+%3Fname%0A&format=text%2Fcsv&timeout=0&debug=on') Projects CSV
         p(ng-if='company.projects.length==0') No data available
   h2 Payments
   table.table.table-striped.payments(ts-wrapper,ng-if='company.payments.length!=0')
      thead
         tr
            th.tablesort-sortable-th(ts-criteria='year|parseInt') Year
            th.tablesort-sortable-th(ts-criteria='paidTo') Paid to
            th.tablesort-sortable-th(ts-criteria='type') Payment Type
            th.tablesort-sortable-th(ts-criteria='currency') Currency
            th.tablesort-sortable-th(ts-criteria='value|parseInt') Value
            th.tablesort-sortable-th(ts-criteria='receipt') Payment or receipt?
            th.tablesort-sortable-th(ts-criteria='id|parseInt') ID
      tbody
         tr(ng-repeat="payment in company.payments",ts-repeat)
            td {{payment.year}}
            td
               a(href="company/{{payment.paidToId}}")
                  span(ng-bind-html="payment.paidTo|sanitize")
            td {{payment.type}}
            td {{payment.currency}}
            td {{payment.value}}
            td {{payment.receipt}}
            td
               a(href="governmentreceipt/{{payment.id}}")
                  span.glyphicon.glyphicon-info-sign(data-toggle="tooltip", data-placement="left", title="9c82db15d194a2c2", aria-hidden="true")
   p(ng-if='company.payments.length==0') No data available
   .download
      span.glyphicon.glyphicon-download(aria-hidden='true')
      span
         |  Download:
         =' '
         a(href='/sparql?default-graph-uri=&query=PREFIX+skos%3A+%3Chttp%3A%2F%2Fwww.w3.org%2F2004%2F02%2Fskos%2Fcore%23%3E%0Aprefix+rp%3A+%3Chttp%3A%2F%2Fresourceprojects.org%2Fdef%2F%3E%0Aprefix+rp_misc%3A+%3Chttp%3A%2F%2Fresourceprojects.org%2Fdef%2Fmisc%2F%3E%0Aprefix+skos_%3A+%3Chttp%3A%2F%2Fwww.w3.org%2F2004%2F02%2Fskos%2Fcore%23%3E%0A%0ASELECT+%3Ftransaction+%3FpaymentOrReceipt+%3Fpayee_name+%3Fcurrency+%28replace%28%3Famount%2C%22%2C%22%2C%22%22%29+as+%3Famount%29+%3Fdate+%3Fyear+%3Ftype+WHERE+%7B%0A++++%3Ftransaction+rp%3Apayer+%3Chttp%3A%2F%2Fresourceprojects.org%2Fcompany%2F2f2508fdb642e947%3E.%0A++++%3Ftransaction+rp%3Avalue+%3Famount.%0A++++%3Ftransaction+a+%3FpaymentOrReceipt.%0A%0A+++++++OPTIONAL+%7B%0A++++++++%3Ftransaction++rp%3Apayee+%3FcountryParty+.%0A++++++++%3FcountryParty+a+rp%3ACountry+.%0A++++++++%3FcountryParty+skos_%3AprefLabel+%3FcountryParty_name.%0A+++++++%7D%0A+++++++OPTIONAL+%7B%0A++++++++%3Ftransaction++rp%3Apayee+%3FgovParty+.%0A++++++++%3FgovParty+a+rp%3AGovernmentParty.%0A++++++++%3FgovParty+skos_%3AprefLabel+%3FgovParty_name.%0A+++++++%7D%0A%0A+++++++%23%23+This+should+be+renamed+payee%2C+but+for+now+we+stick+with+country+to+avoid+reworking+the+html+templates%0A+++++++BIND%28IF%28bound%28%3FgovParty%29%2C%3FgovParty%2C%3FcountryParty%29+as+%3Fpayee%29%0A+++++++BIND%28IF%28bound%28%3FgovParty%29%2Cconcat%28%3FgovParty_name%2C%22+%28%22%2C%3FcountryParty_name%2C%22%29%22%29%2C%3FcountryParty_name%29+as+%3Fpayee_name%29++++%0A%0A%0A++++OPTIONAL+%7B+%3Ftransaction+rp%3Acurrency+%3Fcurrency+%7D%0A%0A++++OPTIONAL+%7B+%3Ftransaction+rp%3Adate+%3Fdate+%7D+%0A++++OPTIONAL+%7B+%3Ftransaction+rp%3Ayear+%3Fyear+%7D%0A++++OPTIONAL+%7B+%3Ftransaction+rp%3ApaymentType+%3FpaymentType.%0A+++++++++++++++%3FpaymentType+skos%3AprefLabel+%3Ftype%0A++++%7D%0A++++%23The+filter+is+needed+because+this+project+name+is+used+twice%3A+%0A++++%23https%3A%2F%2Fgithub.com%2FNRGI%2Fresourceprojects.org-frontend%2Fissues%2F197%0A++++FILTER+%28str%28%3Ftype%29+%21%3D+%22Taxes+levied+on+the+income%2C+production+or+profits+of+companies%2C%22%29%0A%7D%0AGROUP+BY+%3Ftransaction%0AORDER+BY+%3Fdate+%3Fyear%0A&format=text%2Fcsv&timeout=0&debug=on') Payments CSV
   .advanced-links
      .container
         h3
            | Links
            =' '
            small Advanced
         ul
            li
               a(href='company/2f2508fdb642e947') Triples View
            li
               a(href='company/2f2508fdb642e947') Sources
