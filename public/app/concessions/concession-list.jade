.container
    .page-header
        h1 Concessions
            small

    nrgi-list-nav(
    page="page"
    type="record_type"
    show="show_count"
    count="count"
    limit="limit"
    last="last"
    next="next"
    prev="prev"
    first="first"
    select="select")

    table.table.table-striped(about='http://resourceprojects.org/contracts',ts-wrapper)
        thead
            tr
                th.tablesort-sortable-th(ts-criteria='concession_name')
                    | &nbsp; Name
                th.tablesort-sortable-th(ts-criteria='concession_country[concession_country.length-1].country.name')
                    | &nbsp; Country
                th.tablesort-sortable-th(ts-criteria='concession_type[concession_type.length-1].string')
                    | &nbsp; Commodity Type
                th.tablesort-sortable-th(ts-criteria='concession_commodity[concession_commodity.length -1].commodity_name')
                    | &nbsp; Commodity
                th.tablesort-sortable-th(ts-criteria='concession_status[concession_status.length-1].string')
                    | &nbsp; Status
                th.tablesort-sortable-th(ts-criteria='projects|parseInt')
                    | &nbsp; No. Projects
        tbody
            tr(ng-repeat="concession in concessions",ts-repeat)
                td
                    a(href='/concession/{{concession._id}}')
                        span(ng-bind-html="concession.concession_name|sanitize")
                td
                    text(ng-repeat="country in concession.concession_country")
                        a(href='/country/{{country.country._id}}')
                            span(ng-bind-html="country.country.name|sanitize")
                td
                    text(ng-repeat="type in concession.concession_type")
                        | {{type.string| ucfirst}}
                        | {{$last ? '' : ', '}}
                td
                    text(ng-repeat="commodity in concession.concession_commodity")
                        a(href='/commodity/{{commodity._id}}')
                            span(ng-bind-html="commodity.commodity_name|sanitize")
                        | {{$last ? '' : ', '}}
                td
                    text(ng-repeat="status in concession.concession_status")
                        text(ng-if="$last")
                            | {{status.string | ucfirst}}
                            text.small  (true at {{status.timestamp | date:'MM/dd/yyyy @ h:mma' : timezone}})
                td
                    span(ng-if="concession.projects!=0") {{concession.projects}}

    nrgi-list-nav(
    page="page"
    type="record_type"
    show="show_count"
    count="count"
    limit="limit"
    last="last"
    next="next"
    prev="prev"
    first="first"
    select="select")
