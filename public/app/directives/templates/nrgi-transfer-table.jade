button.btn.btn-primary-outline.btn-block(
type="button"
data-toggle="collapse"
ng-click='openClose=!openClose; getTransfers(id,type)'
data-target="#transfers")
    h4.text-justify Payments
//a(data-toggle="collapse" ng-click='openClose=!openClose;getTransfers(id,type)' data-target="#transfers")
//    h2 Payments
#transfers.panel-collapse.collapse.in
    table.load_table.table.table-striped.projects(
    ng-class="transfers.length >= 8 ? 'header-fixed' : ''"
    ts-wrapper
    width="100%"
    height="100%")#transfer-info
        thead
            tr
                th.tablesort-sortable-th(ts-criteria='transfer_year|parseInt') Year
                th.tablesort-sortable-th(
                ng-if="project==true"
                ts-criteria='project.project_name') Project
                th.tablesort-sortable-th(ts-criteria='company.company_name') Paid by
                th.tablesort-sortable-th(
                ng-if="project!=true"
                ts-criteria='country.name') Paid to
                th.tablesort-sortable-th(ts-criteria='transfer_type') Payment Type
                th.tablesort-sortable-th(ts-criteria='transfer_unit') Currency
                th.text-center.tablesort-sortable-th(ts-criteria='transfer_value|parseInt') Value
                th.tablesort-sortable-th(ts-criteria='transfer_level') Level
                th.tablesort-sortable-th(ts-criteria='transfer_audit_type') Payment or receipt?
                th.tablesort-sortable-th(
                ng-if="projectlink==true"
                ts-criteria='transfer_links.name') Projects and Sites
        tbody
            span(
            us-spinner="{radius:32, width:12, length: 0, lines:17, scale: 0.25}"
            spinner-start-active="true"
            spinner-key="spinner-payments")
            tr(
            ng-repeat="transfer in transfers"
            ts-repeat ng-class="expression")
                td.transfer_year {{transfer.transfer_year}}
                //td.transfer_company(ng-if="project==true"): a(href="project/{{transfer.project._id}}")
                //    span(ng-bind-html="transfer.project.proj_name|sanitize")
                td.transfer_company: a(href="company/{{transfer.company._id}}")
                    span(ng-bind-html="transfer.company.company_name|sanitize")
                td.transfer_project(ng-if="project==true"): a(href="project/{{transfer.transfer_company._id}}")
                    span(ng-bind-html="transfer.transfer_company.company_name|sanitize")
                td.transfer_country(ng-if="project!=true"): a(href="country/{{transfer.country.iso2}}")
                    span(ng-bind-html="transfer.country.name|sanitize")
                td.transfer_type {{transfer.transfer_type}}
                td.transfer_unit {{transfer.transfer_unit}}
                td.text-right.transfer_value {{transfer.transfer_value | number}}
                td.transfer_level {{transfer.transfer_level}}
                td.transfer_audit_type {{transfer.transfer_audit_type | addSpaces}}
                td.project_links(ng-if="projectlink===true"): span(ng-repeat="link in transfer.transfer_links | unique: '_id'")
                    a(href="{{link.type}}/{{link.route}}")
                        span(ng-bind-html="link.name|sanitize")
                    | {{$last ? '' : ', '}}
    div(ng-if="transfers.length>0")
        .download
            span.glyphicon.glyphicon-download(aria-hidden='true')
            span
                |  Download:
                =' '
                a(
                href=""
                ng-csv="csv_transfers"
                csv-header="getHeaderTransfers()"
                filename="payments.csv") Payments CSV

