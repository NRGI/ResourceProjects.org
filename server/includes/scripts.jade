//- GEN SCRIPTS
script(type="text/javascript", src="/vendor/jquery/dist/jquery.js")
script(type="text/javascript", src="/vendor/angular/angular.js")

script(type="text/javascript", src="/vendor/tether/src/js/utils.js")
script(type="text/javascript", src="/vendor/tether/dist/js/tether.js")
script(type="text/javascript", src="/vendor/toastr/toastr.js")
script(type="text/javascript", src="/vendor/bootstrap/dist/js/bootstrap.js")
script(type="text/javascript", src="/vendor/angular-resource/angular-resource.js")
script(type="text/javascript", src="/vendor/angular-route/angular-route.js")
script(type="text/javascript", src="/vendor/angular-filter/dist/angular-filter.js")
script(type="text/javascript", src="/vendor/ngDialog/js/ngDialog.js")
script(type="text/javascript", src="/vendor/iso-3166-country-codes-angular/dist/iso-3166-country-codes-angular.min.js")
script(type="text/javascript", src="/vendor/leaflet/dist/leaflet.js")
script(type="text/javascript", src="/vendor/esri-leaflet/dist/esri-leaflet.js")
script(type="text/javascript", src="/vendor/angular-leaflet-directive/dist/angular-leaflet-directive.min.js")
script(type="text/javascript", src="https://api.mapbox.com/mapbox.js/plugins/leaflet-fullscreen/v1.0.1/Leaflet.fullscreen.min.js")
script(type="text/javascript", src="/plugin/bootstrap-typeahead.js")
script(type="text/javascript", src="/vendor/angular-tablesort/js/angular-tablesort.js")
script(type="text/javascript", src="/vendor/underscore/underscore.js")
script(type="text/javascript", src="/vendor/angular-underscore/angular-underscore.min.js")
script(type="text/javascript", src="/vendor/restangular/dist/restangular.js")
script(type="text/javascript", src="/vendor/ng-csv/build/ng-csv.js")
script(type="text/javascript", src="/vendor/angular-sanitize/angular-sanitize.js")
script(type="text/javascript", src="/vendor/spin.js/spin.js")
script(type="text/javascript", src="/vendor/angular-spinner/angular-spinner.js")
script(type="text/javascript", src="/vendor/plotlyjs/plotly.js")
script(type="text/javascript", src="/vendor/d3/d3.min.js")
script(type="text/javascript", src="/vendor/topojson/topojson.min.js")
script(type="text/javascript", src="/vendor/nvd3/build/nv.d3.min.js")
script(type="text/javascript", src="/vendor/angular-nvd3/dist/angular-nvd3.min.js")
script(type="text/javascript", src="/vendor/bootstrap-select/dist/js/bootstrap-select.js")

script(type="text/javascript", src="/vendor/textAngular/dist/textAngular-rangy.min.js")
script(type="text/javascript", src="/vendor/textAngular/dist/textAngular-sanitize.min.js")
script(type="text/javascript", src="/vendor/textAngular/dist/textAngular.min.js")

script(type="text/javascript", src="/vendor/angular-plotly/src/angular-plotly.js")
script(type='text/javascript').
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
        (i[r].q=i[r].q || []).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
        m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
    ga('create', 'UA-59246536-4', 'resourceprojects.org');
    ga('send', 'pageview');
script(type="text/javascript", src="/vendor/angular-google-analytics/dist/angular-google-analytics.min.js")
script(type="text/javascript", src="/vendor/ngInfiniteScroll/build/ng-infinite-scroll.min.js")
script(type='text/javascript').
    $(document).ready(function () {
        var row = $('table > tbody > tr:first');
        var table = $('table > tbody');
        for (i=0; i<100; i++) {
            table.append(row.clone());
        }
        var oldURL = "";
        function checkURLchange(currentURL) {
            if (currentURL != oldURL) {
                oldURL = currentURL;
            }
        }
        oldURL = window.location.href;
        setInterval(function () {
            $('.table-fixed-header').fixedHeader();
            checkURLchange(window.location.href);
        }, 1000);
        setTimeout(function(){
            $('.typeahead').typeahead({
                source: function (query, process) {
                    $('.typeahead').addClass('wait');
                    return $.get('/api/search', {query: query.toString()}, function (data) {
                        $('.typeahead').removeClass('wait');
                        return process(data);
                    }, 'json');
                },
                afterSelect: function (obj) {
                    $('.typeahead').attr('disabled', true);
                    if (obj.type == 'country') {
                        window.location = '/' + obj.type + '/' + obj.iso2;
                    }
                    else if (obj.type == 'companygroup') {
                        window.location = '/group/' + obj._id;
                    } else if (obj.type == 'commodity') {
                        window.location = '/commodity/' + obj.commodity_id;
                    } else {
                        window.location = '/' + obj.type + '/' + obj._id;
                    }
                },
                displayText: function (item) {
                    return item.name;
                }
            });
        },100)
    });
    (function ($) {
        $(document).on('click', '.dropdown', function (e) {
            e.stopPropagation();
        });
        $.fn.fixedHeader = function (options) {
            var config = {
                topOffset: 50
            };
            if (options) {
                $.extend(config, options);
            }
            return this.each(function () {
                var o = $(this);
                var $win = $(window);
                var $head = $('thead.header', o);
                var isFixed = 0;
                var headTop = $head.length && $head.offset().top - config.topOffset;

                function processScroll() {
                    if (!o.is(':visible')) {
                        return;
                    }
                    if ($('thead.header-copy').size()) {
                        $('thead.header-copy').width($('thead.header').width());
                    }
                    var i;
                    var scrollTop = $win.scrollTop();
                    var t = $head.length && $head.offset().top - config.topOffset;
                    if (!isFixed && headTop !== t) {
                        headTop = t;
                    }
                    if (scrollTop >= headTop && !isFixed) {
                        isFixed = 1;
                    } else if (scrollTop <= headTop && isFixed) {
                        isFixed = 0;
                    }
                    isFixed ? $('thead.header-copy', o).offset({
                    }).removeClass('hide') : $('thead.header-copy', o).addClass('hide');
                }
                $win.on('scroll', processScroll);
                $head.on('click', function () {
                    if (!isFixed) {
                        setTimeout(function () {
                            $win.scrollTop($win.scrollTop() - 47);
                        }, 10);
                    }
                });
                $('.header-copy').removeClass('header').addClass('header-copy table-header-fixed').appendTo(o);
                var header_width = $head.width();
                o.find('thead.header-copy').width(header_width);
                o.find('thead.header > tr:first > th').each(function (i, h) {
                    var w = $(h).width();
                    o.find('thead.header-copy> tr > th:eq(' + i + ')').width(w);
                });
                $head.css({
                    margin: '0 auto',
                    width: o.width()
                });
                processScroll();
            });
        };
    })(jQuery);
//- MAIN APP
script(type="text/javascript", src="/app/app.js")
script(type="text/javascript", src="/app/common/nrgiNotifier.js")
script(type="text/javascript", src="/app/common/nrgiFilter.js")
script(type="text/javascript", src="/app/main/nrgiMainCtrl.js")
script(type="text/javascript", src="/app/main/nrgiNavBarCtrl.js")
//companies
script(type="text/javascript", src="/app/dynamic/companies/nrgiCompanyListCtrl.js")
script(type="text/javascript", src="/app/dynamic/companies/nrgiCompanyDetailCtrl.js")
//company groups
script(type="text/javascript", src="/app/dynamic/groups/nrgiGroupListCtrl.js")
script(type="text/javascript", src="/app/dynamic/groups/nrgiGroupDetailCtrl.js")
//concessions
script(type="text/javascript", src="/app/dynamic/concessions/nrgiConcessionListCtrl.js")
script(type="text/javascript", src="/app/dynamic/concessions/nrgiConcessionDetailCtrl.js")
//contracts
script(type="text/javascript", src="/app/dynamic/contracts/nrgiContractListCtrl.js")
script(type="text/javascript", src="/app/dynamic/contracts/nrgiContractDetailCtrl.js")
//countries
script(type="text/javascript", src="/app/dynamic/countries/nrgiCountryListCtrl.js")
script(type="text/javascript", src="/app/dynamic/countries/nrgiCountryDetailCtrl.js")
//payments
script(type="text/javascript", src="/app/dynamic/transfers/nrgiTransferListCtrl.js")
//projects
script(type="text/javascript", src="/app/dynamic/projects/nrgiProjectListCtrl.js")
script(type="text/javascript", src="/app/dynamic/projects/nrgiProjectDetailCtrl.js")
//sources
script(type="text/javascript", src="/app/dynamic/sources/nrgiSourceListCtrl.js")
script(type="text/javascript", src="/app/dynamic/sources/nrgiSourceDetailCtrl.js")
script(type="text/javascript", src="/app/dynamic/commodities/nrgiCommodityListCtrl.js")
script(type="text/javascript", src="/app/dynamic/commodities/nrgiCommodityDetailCtrl.js")

//sites
script(type="text/javascript", src="/app/dynamic/sites/nrgiSiteListCtrl.js")
script(type="text/javascript", src="/app/dynamic/sites/nrgiSiteDetailCtrl.js")
script(type="text/javascript", src="/app/dynamic/sites/nrgiMapSiteCtrl.js")
script(type="text/javascript", src="/app/dynamic/sourceTypes/nrgiSourceTypeDetailCtrl.js")
script(type="text/javascript", src="/app/dynamic/sourceTypes/nrgiSourceTypeListCtrl.js")

//pieChart
script(type="text/javascript", src="/app/dynamic/pieChart/nrgiPieChartCtrl.js")

//about page
script(type="text/javascript", src="/app/static/about/nrgiAboutCtrl.js")

//glossary page
script(type="text/javascript", src="/app/static/glossary/nrgiGlossaryCtrl.js")

//- DIRECTIVES
//  tables
script(type="text/javascript", src="/app/directives/directives/nrgi-company-table.js")
script(type="text/javascript", src="/app/directives/directives/nrgi-contract-table.js")
script(type="text/javascript", src="/app/directives/directives/nrgi-concession-table.js")
script(type="text/javascript", src="/app/directives/directives/nrgi-production-table.js")
script(type="text/javascript", src="/app/directives/directives/nrgi-project-table.js")
script(type="text/javascript", src="/app/directives/directives/nrgi-site-table.js")
script(type="text/javascript", src="/app/directives/directives/nrgi-sources-table.js")
script(type="text/javascript", src="/app/directives/directives/nrgi-transfer-table.js")
script(type="text/javascript", src="/app/directives/directives/nrgi-company-of-operation-table.js")
script(type="text/javascript", src="/app/directives/directives/nrgi-scroll-table.js")
//  general
script(type="text/javascript", src="/app/directives/directives/nrgi-list-nav.js")
script(type="text/javascript", src="/app/directives/directives/nrgi-leaflet.js")
script(type="text/javascript", src="/app/directives/directives/nrgi-summary-stats.js")
script(type="text/javascript", src="/app/directives/directives/nrgi-last-added.js")
script(type="text/javascript", src="/app/directives/directives/nrgi-sunburst.js")
script(type ="text/javascript",src= "/app/directives/directives/nrgi-map.js")

//- DIRECTIVE CTRLS
//  tables
script(type="text/javascript", src="/app/directives/controllers/nrgiCompanyTableCtrl.js")
script(type="text/javascript", src="/app/directives/controllers/nrgiCompanyOperationTableCtrl.js")
script(type="text/javascript", src="/app/directives/controllers/nrgiContractTableCtrl.js")
script(type="text/javascript", src="/app/directives/controllers/nrgiConcessionTableCtrl.js")
script(type="text/javascript", src="/app/directives/controllers/nrgiProductionTableCtrl.js")
script(type="text/javascript", src="/app/directives/controllers/nrgiProjectTableCtrl.js")
script(type="text/javascript", src="/app/directives/controllers/nrgiSiteTableCtrl.js")
script(type="text/javascript", src="/app/directives/controllers/nrgiSourcesTableCtrl.js")
script(type="text/javascript", src="/app/directives/controllers/nrgiTransferTableCtrl.js")
//  general
script(type="text/javascript", src="/app/directives/controllers/nrgiListNavCtrl.js")
script(type="text/javascript", src="/app/directives/controllers/nrgiLeafletCtrl.js")
script(type="text/javascript", src="/app/directives/controllers/nrgiSummaryStatsCtrl.js")
script(type="text/javascript", src="/app/directives/controllers/nrgiLastAddedCtrl.js")
script(type="text/javascript", src="/app/directives/controllers/nrgiSunburstCtrl.js")
script(type="text/javascript", src="/app/directives/controllers/nrgiMapCtrl.js")


//- SERVICES
script(type="text/javascript", src="/app/services/nrgiServices.js")
script(type="text/javascript", src="/app/services/nrgiAuthSrvc.js")
script(type="text/javascript", src="/app/services/nrgiIdentitySrvc.js")
script(type="text/javascript", src="/app/services/nrgiTablesSrvc.js")
script(type="text/javascript", src="/app/services/nrgiUserSrvc.js")
script(type="text/javascript", src="/app/services/nrgiMapSrvc.js")
script(type="text/javascript", src="/app/services/nrgiSummaryStatsSrvc.js")
script(type="text/javascript", src="/app/services/nrgiLastAddedSrvc.js")
script(type="text/javascript", src="/app/services/nrgiContentSrvc.js")
script(type="text/javascript", src="/app/services/nrgiProjectsSrvc.js")

//- METHODS
script(type="text/javascript", src="/app/services/methods/nrgiCommoditiesMethodSrvc.js")
script(type="text/javascript", src="/app/services/methods/nrgiCompaniesMethodSrvc.js")
script(type="text/javascript", src="/app/services/methods/nrgiConcessionsMethodSrvc.js")
script(type="text/javascript", src="/app/services/methods/nrgiCountriesMethodSrvc.js")
script(type="text/javascript", src="/app/services/methods/nrgiDatasetActionMethodSrvc.js")
script(type="text/javascript", src="/app/services/nrgiDuplicatesSrvc.js")
script(type="text/javascript", src="/app/services/methods/nrgiDatasetMethodSrvc.js")
script(type="text/javascript", src="/app/services/methods/nrgiGroupsMethodSrvc.js")
script(type="text/javascript", src="/app/services/methods/nrgiProjectsMethodSrvc.js")
script(type="text/javascript", src="/app/services/methods/nrgiSitesMethodSrvc.js")
script(type="text/javascript", src="/app/services/methods/nrgiSourcesMethodSrvc.js")
script(type="text/javascript", src="/app/services/methods/nrgiSourceTypesMethodSrvc.js")
script(type="text/javascript", src="/app/services/methods/nrgiUserMethodSrvc.js")
script(type="text/javascript", src="/app/services/methods/nrgiContentMethodSrvc.js")


// DO NOT MERGE TO PRODUCTION! FOR STAGING USE ONLY!
script(type="text/javascript", src="/app/services/nrgiDestroySrvc.js")



//- ACCT CTRLS
script(type="text/javascript", src="/app/account/nrgiLoginCtrl.js")
script(type="text/javascript", src="/app/account/nrgiProfileCtrl.js")

//- ADMIN CTRLS
script(type="text/javascript", src="/app/admin/etl/nrgiEtlCtrl.js")
script(type="text/javascript", src="/app/admin/etl/nrgiDatasetCreateCtrl.js")
script(type="text/javascript", src="/app/admin/etl/nrgiReconcileCtrl.js")
script(type="text/javascript", src="/app/admin/sourceTypes/nrgiSourceTypeAdminCreateCtrl.js")
script(type="text/javascript", src="/app/admin/sourceTypes/nrgiSourceTypeAdminCtrl.js")
script(type="text/javascript", src="/app/admin/sourceTypes/nrgiSourceTypeAdminUpdateCtrl.js")
script(type="text/javascript", src="/app/admin/users/nrgiUserAdminCreateCtrl.js")
script(type="text/javascript", src="/app/admin/users/nrgiUserAdminCtrl.js")
script(type="text/javascript", src="/app/admin/users/nrgiUserAdminUpdateCtrl.js")

//CMS
script(type="text/javascript", src="/app/admin/cms/aboutPage/nrgiAboutPageUpdateCtrl.js")
script(type="text/javascript", src="/app/admin/cms/glossaryPage/nrgiGlossaryPageUpdateCtrl.js")
script(type="text/javascript", src="/app/admin/cms/landingPage/nrgiLandingPageUpdateCtrl.js")


//script(type="text/javascript", src="/app/admin/commodities/nrgCommodityAdminCtrl.js")
//script(type="text/javascript", src="/app/admin/commodities/nrgiCommodityAdminCreateCtrl.js")
//script(type="text/javascript", src="/app/admin/commodities/nrgiCommodityAdminUpdateCtrl.js")
//script(type="text/javascript", src="/app/admin/companies/nrgCompanyAdminCtrl.js")
//script(type="text/javascript", src="/app/admin/companies/nrgiCompanyAdminCreateCtrl.js")
//script(type="text/javascript", src="/app/admin/companies/nrgiCompanyAdminUpdateCtrl.js")
//script(type="text/javascript", src="/app/admin/concessions/nrgConcessionAdminCtrl.js")
//script(type="text/javascript", src="/app/admin/concessions/nrgiConcessionAdminCreateCtrl.js")
//script(type="text/javascript", src="/app/admin/concessions/nrgiConcessionAdminUpdateCtrl.js")
//script(type="text/javascript", src="/app/admin/countries/nrgCountryAdminCtrl.js")
//script(type="text/javascript", src="/app/admin/countries/nrgiCountryAdminCreateCtrl.js")
//script(type="text/javascript", src="/app/admin/countries/nrgiCountryAdminUpdateCtrl.js")
//script(type="text/javascript", src="/app/admin/groups/nrgiGroupAdminCtrl.js")
//script(type="text/javascript", src="/app/admin/groups/nrgiGroupAdminCreateCtrl.js")
//script(type="text/javascript", src="/app/admin/groups/nrgiGroupAdminUpdateCtrl.js")
//script(type="text/javascript", src="/app/admin/projects/nrgiProjectAdminCtrl.js")
//script(type="text/javascript", src="/app/admin/projects/nrgiProjectAdminCreateCtrl.js")
//script(type="text/javascript", src="/app/admin/projects/nrgiProjectAdminUpdateCtrl.js")
//script(type="text/javascript", src="/app/admin/sites/nrgiSiteAdminCtrl.js")
//script(type="text/javascript", src="/app/admin/sites/nrgiSiteAdminCreateCtrl.js")
//script(type="text/javascript", src="/app/admin/sites/nrgiSiteAdminUpdateCtrl.js")
//script(type="text/javascript", src="/app/admin/sources/nrgiSourceAdminCtrl.js")
//script(type="text/javascript", src="/app/admin/sources/nrgiSourceAdminCreateCtrl.js")
//script(type="text/javascript", src="/app/admin/sources/nrgiSourceAdminUpdateCtrl.js")